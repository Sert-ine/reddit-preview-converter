<!DOCTYPE html>
<html>
<head>
<title>Preview Reddit Link Converter
</title>
<style>
  #insertion_box
  {
    padding: 5px;
  }
</style>

</head>
<body>
  <section>
    <div contenteditable="true" id="insertion_box">
    </div>
    <button type="Button" id="SubmitButton" onclick="ConvertTxt(this)">Convert link</button>
  </section>
</body>
<script>
function ConvertTxt(el)
{
  const TxtEl= document.getElementById("insertion_box");
  var Link = TxtEl.innerHTML;
  console.log("link: "+Link);
  let regex = /\?format=/i;
  console.log("regex: "+regex);
  let pos = Link.indexOf(regex);
  console.log("pos: "+pos);
  Link = Link.slice(0,pos);
  console.log("removed end: "+Link);
  Link.replace("preview", 'i');
  console.log("final link: "+Link);
  //link format = preview.redd.it/l1pqfp7bw4xa1.gif?format=mp4&v=enabled&s=b250551c08f8780810e4a58a1c7688f3b0c795b6
  //grab everything before the ?: "[A-Za-z]+://([A-Za-z]+(\.[A-Za-z]+)+)/([A-Za-z0-9]+(\.[A-Za-z0-9]+)+)\"
  TxtEl.innerHTML = Link;
}
</script>
</html>
